
# Техническое задание (ТЗ): WinMaintain

Дата: 2025-12-28

## 1. Назначение
WinMaintain — утилита обслуживания Windows 10/11 для:
- аудита диска и “куда ушло место”,
- безопасной очистки типового мусора,
- резервного копирования профилей браузеров,
- сборки логов/отчётов в один архив (“сессия”),
- проверки готовности к Windows 11 (best-effort).

## 2. Цели
1) Сделать запуск “как обычная программа” — **один EXE с UI**.  
2) Обеспечить работу **без установленного Python** на чужих ПК.  
3) Дать повторяемые результаты: отчёты + логи + архив сессии.  

## 3. Состав решения
### 3.1 .NET Launcher (основной артефакт)
- Single-file, self-contained EXE.
- Внутри: `payload.zip`.
- На старте:
  - распаковка в `%LOCALAPPDATA%\WinMaintain\toolkit`
  - запуск выбранных действий (батники/ps1) из распакованного toolkit
- UI кнопки:
  - Audit
  - Dry-run
  - Full cleanup (UAC)
  - Backup browsers
  - Zip session
  - Win11 readiness
  - Open logs / Open reports

### 3.2 PowerShell toolkit (в payload)
Режимы:
- AuditOnly: сбор инвентаризации и “топ-дир”.
- Full: системная очистка (DISM/cleanmgr), обновления/Temp/Recycle Bin, кэши браузеров, кэши dev tools, опционально NVIDIA.

Выходы:
- `logs\YYYY-MM-DD\*.txt`
- `audit_*.json` (где возможно)
- Понятные сообщения в консоли.

### 3.3 Python scanner (опционально, второй артефакт)
- Сборка PyInstaller *onedir*.
- Команды: scan / report / collect-session.
- Выходы: JSON + CSV в `out\` рядом с exe или в `%LOCALAPPDATA%\WinMaintain\out`.

## 4. Функциональные требования
### 4.1 Аудит
- Снять свободное место по дискам.
- Быстрый “Top dirs” по профилю пользователя.
- Глубокий скан основных мест:
  - `%LOCALAPPDATA%`
  - `%APPDATA%`
  - `C:\Windows\Temp`
  - `C:\Windows\SoftwareDistribution\Download`

### 4.2 Очистка
- Dry-run режим (без удаления).
- Execute режим (с удалением) + UAC для системных операций.
- Best-effort: если файл занят — фиксировать в логах и продолжать.

### 4.3 Бэкап браузеров
- Edge, Yandex, Chrome (если есть), OperaGX.
- Вывод JSON результата (что скопировалось/нет).
- Рекомендуемый путь: `D:\Backups\Browsers\browsers_backup_YYYYMMDD_HHMMSS\`

### 4.4 Сборка сессии
- Один архив с:
  - логами текущего дня,
  - отчётами out,
  - сведением “до/после” по свободному месту.
- Формат: zip.

## 5. Нефункциональные требования
- Windows 10/11 x64.
- Устойчивость: не падать на частных ошибках (права, занятые файлы).
- Прозрачность: логи понятны пользователю.
- Безопасность: не трогать пользовательские документы вне целей (не удалять проекты/фото/документы).

## 6. Риски и ограничения
- SFX/onefile упаковки могут ловить ложные срабатывания AV.
- DISM/cleanmgr могут дать небольшой эффект на “уже чистых” системах.
- Кэши браузеров/IDE не всегда чистятся без закрытия приложений.

## 7. Критерии приёмки
- Launcher запускается на ПК без Python.
- Full cleanup запрашивает UAC и выполняется.
- Логи и отчёты создаются, Zip session собирается.
- Python scanner (если установлен) собирается в EXE и работает без Python на целевом ПК.
